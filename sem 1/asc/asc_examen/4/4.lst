     1                                  bits 32
     2                                  global start
     3                                  
     4                                  extern exit, scanf, printf
     5                                  import exit msvcrt.dll
     6                                  import scanf msvcrt.dll
     7                                  import printf msvcrt.dll
     8                                  
     9                                  
    10                                  segment data use32 class = data
    11 00000000 0000<rept>                  counter times 255 db 0, 0
    12 000001FE 0000<rept>                  token times 10 db 0, 0
    13                                      
    14 00000212 257300                      r_format db "%s", 0
    15 00000215 2563202D2025642563-         w_format db "%c - %d%c", 0
    15 0000021E 00                 
    16                                      
    17 0000021F 00000000                    curr dd 0
    18                                      
    19                                  
    20                                  segment code use32 class = code
    21                                      start:
    22                                          rep_1:
    23 00000000 68[FE010000]                        push dword token
    24 00000005 68[12020000]                        push dword r_format
    25 0000000A FF15[00000000]                      call [scanf]
    26 00000010 83C408                              add esp, 4 * 2
    27                                              
    28 00000013 BE[FE010000]                        mov esi, token
    29 00000018 8A06                                mov al, [esi]
    30 0000001A 3C2E                                cmp al, '.'
    31 0000001C 7414                                je exit_rep_1
    32                                              
    33                                              rep_2:
    34 0000001E B800000000                              mov eax, 0
    35 00000023 AC                                      lodsb
    36 00000024 3C00                                    cmp al, 0
    37 00000026 7408                                    je exit_rep_2
    38                                                  
    39 00000028 FE80[00000000]                          inc byte [counter + eax]
    40                                              
    41 0000002E EBEE                                    jmp rep_2
    42                                              
    43                                              exit_rep_2:
    44 00000030 EBCE                                jmp rep_1
    45                                          
    46                                          exit_rep_1:
    47                                          rep_3:
    48 00000032 813D[1F020000]FF00-                 cmp dword [curr], 255
    48 0000003A 0000               
    49 0000003C 7430                                je exit_rep_3
    50                                              
    51 0000003E 8B0D[1F020000]                      mov ecx, [curr]
    52 00000044 B800000000                          mov eax, 0
    53 00000049 8A81[00000000]                      mov al, [counter + ecx]
    54 0000004F 83F800                              cmp eax, 0
    55 00000052 7412                                je no_display
    56                                              
    57 00000054 6A0A                                push dword 10
    58 00000056 50                                  push eax
    59 00000057 51                                  push ecx
    60 00000058 68[15020000]                        push dword w_format
    61 0000005D FF15[00000000]                      call [printf]
    62 00000063 83C410                              add esp, 4 * 4
    63                                              
    64                                              no_display:
    65 00000066 FF05[1F020000]                      inc dword [curr]
    66 0000006C EBC4                                jmp rep_3
    67                                         
    68                                          exit_rep_3:
    69 0000006E 6A00                            push dword 0
    70 00000070 FF15[00000000]                  call [exit]
